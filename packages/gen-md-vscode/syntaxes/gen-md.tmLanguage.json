{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "gen-md",
  "scopeName": "source.gen-md",
  "patterns": [
    { "include": "#frontmatter" },
    { "include": "#input-block" },
    { "include": "#markdown" }
  ],
  "repository": {
    "frontmatter": {
      "begin": "^---\\s*$",
      "end": "^---\\s*$",
      "name": "meta.frontmatter.gen-md",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.frontmatter.begin.gen-md" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.frontmatter.end.gen-md" }
      },
      "patterns": [
        { "include": "#yaml-gen-md-keys" },
        { "include": "#yaml-key-value" },
        { "include": "#yaml-array" },
        { "include": "#yaml-comment" }
      ]
    },
    "yaml-gen-md-keys": {
      "match": "^\\s*(name|description|context|skills|prompt|output)\\s*(:)\\s*(.*)$",
      "captures": {
        "1": { "name": "keyword.other.gen-md" },
        "2": { "name": "punctuation.separator.key-value.yaml.gen-md" },
        "3": { "name": "string.unquoted.yaml.gen-md" }
      }
    },
    "yaml-key-value": {
      "match": "^\\s*(\\w+)\\s*(:)\\s*(.*)$",
      "captures": {
        "1": { "name": "entity.name.tag.yaml.gen-md" },
        "2": { "name": "punctuation.separator.key-value.yaml.gen-md" },
        "3": { "name": "string.unquoted.yaml.gen-md" }
      }
    },
    "yaml-array": {
      "match": "^\\s*-\\s+(.*)$",
      "captures": {
        "0": { "name": "meta.array-item.yaml.gen-md" },
        "1": { "name": "string.quoted.yaml.gen-md" }
      }
    },
    "yaml-comment": {
      "match": "#.*$",
      "name": "comment.line.number-sign.yaml.gen-md"
    },
    "input-block": {
      "begin": "<input>",
      "end": "</input>",
      "name": "meta.input-block.gen-md",
      "beginCaptures": {
        "0": { "name": "punctuation.definition.tag.begin.gen-md" }
      },
      "endCaptures": {
        "0": { "name": "punctuation.definition.tag.end.gen-md" }
      },
      "patterns": [
        { "include": "#prompt-variable" },
        { "include": "text.html.markdown" }
      ]
    },
    "prompt-variable": {
      "match": "\\$\\w+",
      "name": "variable.other.gen-md"
    },
    "markdown": {
      "patterns": [
        { "include": "text.html.markdown" }
      ]
    }
  }
}
